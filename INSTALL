Setup on Arch Linux
===================

1) Clone the AUR project:

   $ cd /srv/http/
   $ git clone git://projects.archlinux.org/aurweb.git

2) Setup a web server with PHP and MySQL. Configure the web server to redirect
   all URLs to /index.php/foo/bar/. The following block can be used with nginx:

    location ~ .* {
        rewrite ^/(.*)$ /index.php/$1 last;
    }

3) Copy conf/config.proto to conf/config and adjust the configuration.

4) Create a new MySQL database and a user and import the AUR SQL schema:

    $ mysql -uaur -p AUR </srv/http/aurweb/schema/aur-schema.sql

5) Generate templates for new Git repositories:

    $ /srv/http/aurweb/scripts/git-integration/gen-templates.py

6) Create a new user:

    # useradd -U -d /srv/http/aurweb -c 'AUR user' aur

7) Install the git-auth wrapper script:

    # cd /srv/http/aurweb/scripts/git-integration/
    # cp git-auth.sh /usr/local/bin/aur-git-auth
    # chmod 755 /usr/local/bin/aur-git-auth

8) Configure sshd(8) for the AUR. Add the following lines at the end of your
   sshd_config(5) and restart the sshd. Note that OpenSSH 6.9 or newer is
   needed!

    Match User aur
        PasswordAuthentication no
        AuthorizedKeysCommand /usr/local/bin/aur-git-auth "%t" "%k"
        AuthorizedKeysCommandUser aur

